<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pygame.js Example</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <script>
        require.config({
            paths: {
                'pygame': 'https://cdn.jsdelivr.net/gh/pygamejs/pygame/pygame.js'
            }
        });

        require(['pygame'], function(pygame) {
            pygame.ready(function() {
                // Pygame 초기화
                pygame.init();

                // 화면 설정
                var screen = pygame.display.set_mode([800, 600]);

                // 색 정의
                var WHITE = [255, 255, 255];
                var BLACK = [0, 0, 0];
                var RED = [255, 0, 0];

                // 점전하 클래스
                class PointCharge {
                    constructor(x, q) {
                        this.x = x;
                        this.q = q;
                    }
                }

                // 전기력 계산기 클래스
                class ElectricFieldCalculator {
                    constructor(x_min, x_max) {
                        this.charges = [];
                        this.x_min = x_min;
                        this.x_max = x_max;
                    }

                    add_charge(x, q) {
                        if (x < this.x_min || x > this.x_max) {
                            return;
                        }
                        this.charges.push(new PointCharge(x, q));
                    }

                    remove_charge(x) {
                        this.charges = this.charges.filter(charge => charge.x !== x);
                    }

                    draw_forces(screen) {
                        // 전기력 계산 및 렌더링 로직
                        this.charges.forEach(charge => {
                            var charge_pos = [charge.x * 50 + 400, 300];
                            pygame.draw.circle(screen, RED, charge_pos, 10);
                        });
                    }
                }

                var efc = new ElectricFieldCalculator(-10, 10);

                // 메인 루프
                function main_loop() {
                    // 이벤트 루프
                    for (var event of pygame.event.get()) {
                        if (event.type === pygame.QUIT) {
                            pygame.quit();
                            return;
                        }
                        if (event.type === pygame.MOUSEBUTTONDOWN) {
                            var x = Math.round((event.pos[0] - 400) / 50);
                            if (event.button === 1) { // 왼쪽 클릭
                                efc.add_charge(x, 1);
                            } else if (event.button === 3) { // 오른쪽 클릭
                                efc.remove_charge(x);
                            }
                        }
                    }

                    // 화면 지우기
                    screen.fill(WHITE);

                    // 전기력 렌더링
                    efc.draw_forces(screen);

                    // 화면 업데이트
                    pygame.display.flip();
                    window.requestAnimationFrame(main_loop);
                }

                // 메인 루프 시작
                main_loop();
            });
        });
    </script>
</head>
<body>
</body>
</html>
